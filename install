#!/bin/bash
set -e

# Get location of this script.
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null && pwd )"
BACKUP_DIR=${HOME}/.backup_dotfiles

# Set up Vundle.
vundle_path="vim/bundle/Vundle.vim"
if [ ! -d ${vundle_path} ]; then
   	git clone git@github.com:VundleVim/Vundle.vim.git
fi

# Install Vim plugins.
vim +PluginInstall +qall

# Fetch dependencies.
git submodule update --init --recursive

# Create symbolic links.
mkdir -p ${BACKUP_DIR}
link () {
	filename=$1
   	dotfile=${DIR}//${filename}
	rootfile=${HOME}/.${filename}
	if [ -e $rootfile ] && [ ! -L $rootfile ]; then
		echo "Moving $rootfile" to ${BACKUP_DIR}..."
		mv $rootfile ${BACKUP_DIR}
	echo "Linking $rootfile to $dotfile..."
        ln -s $dotfile $rootfile
    fi
}

# Symlink the following files.
symlink_list="vimrc zshrc"

for file in *; do
	# Check if the file or directory should be symlinked.
	if echo $symlink_list | grep -w $file > /dev/null; then
		link $file
	fi
done
